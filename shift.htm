<!DOCTYPE html>
<html>
<head>
    <title>Shift: Simple, Colorful, Fun</title>
    <link rel="stylesheet" type="text/css" href="css/shift.css" />

    <script type="text/javascript" src="js/Util.js"></script>
    <script type="text/javascript" src="js/GameEngine.js"></script>
    <script type="text/javascript" src="js/WaveGenerator.js"></script>
    <script type="text/javascript" src="js/AdGenerator.js"></script>
    <script type="text/javascript" src="js/SoundManager.js"></script>

    <!-- UI Wrapper Components -->
    <script type="text/javascript" src="js/ui/HealthBlock.js"></script>
    <script type="text/javascript" src="js/ui/UIElement.js"></script>
    <script type="text/javascript" src="js/ui/WaveProgressUI.js"></script>
    <script type="text/javascript" src="js/ui/Shape.js"></script>
    <script type="text/javascript" src="js/ui/SliderUI.js"></script>
    <script type="text/javascript" src="js/ui/GameBoard.js"></script>

    <!-- Touch handling components -->
    <script type="text/javascript" src="js/TouchPoint.js"></script>
    <script type="text/javascript" src="js/TouchPointManager.js"></script>

    <script>
        //Global Variable
        var _adGenerator = null;
        var gameEngine;
        var sliderUI;
        var levelData = [{
            totalTicks: 60 * 120,
            subWaves: [0.33, 0.66]
        }];

        function Init() {
            _adGenerator = new AdGenerator();

            var waveUI = new WaveProgressUI(document.getElementById("waveProgressUI"));
            gameEngine = new GameEngine(levelData, waveUI);

            sliderUI = new SliderUI(document.getElementById("sliderUI"), gameEngine);
            sliderUI.initUI();

            window.blackSquare = new HealthBlock("blackSquare");

            // Start first level
            gameEngine.advanceLevel();

            SoundManager.setupAudio("soundManager", "audioSingles", "audioInstances");

            requestAnimationFrame(GameLoop);
        }

        function GameLoop() {
            gameEngine.processTick();
            _adGenerator.processTick();

            requestAnimationFrame(GameLoop);
        }
    </script>
</head>
<body onload="Init();">
    <div id="screenBoard" class="screen">
        <div id="panelTop" class="panel">
            <div id="panelAd" class="subPanel">
            </div>
            <div id="panelPieceHints" class="subPanel">
            </div>
            <div id="panelWaveProgress" class="subPanel">
                <div id="waveProgressUI">
                    <div id="progressBar">
                        <div id="progressIndicator">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="panelMid" class="panel">
            <div id="panelBlackSquare" class="subPanel">
                <div id="blackSquare"></div>
            </div>
            <div id="panelLawnmowers" class="subPanel">
            </div>
            <div id="panelGameBoard" class="subPanel">
            </div>
        </div>

        <div id="panelBottom" class="panel">
            <div id="panelSocial" class="subPanel">
                <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://shift.azurewebsites.net" data-text="I just played ShiftTheGame." data-via="JustRogDigiTec" data-hashtags="ShiftTheGame" data-dnt="true">Tweet</a>
            </div>
            <div id="panelSliders" class="subPanel">
                <div id="sliderUI">
                    <div class="sliderButtons" data-column="0" data-key="a">a</div>
                    <div class="sliderButtons" data-column="1" data-key="s">s</div>
                    <div class="sliderButtons" data-column="2" data-key="d">d</div>
                    <div class="sliderButtons" data-column="3" data-key="f">f</div>
                    <div class="sliderButtons" data-column="4" data-key="j">j</div>
                    <div class="sliderButtons" data-column="5" data-key="k">k</div>
                    <div class="sliderButtons" data-column="6" data-key="l">l</div>
                    <div class="sliderButtons" data-column="7" data-key=";">;</div>
                </div>
            </div>
        </div>

        <div id="templates">
            <svg class="shape square" xmlns="http://www.w3.org/2000/svg">
                <rect x="2" y="2" width="44" height="44" class="path"></rect>
            </svg>

            <svg class="shape circle" xmlns="http://www.w3.org/2000/svg">
                <circle cx="24" cy="24" r="22" class="path"></circle>
            </svg>

            <svg class="shape triangle" xmlns="http://www.w3.org/2000/svg">
                <polygon points="2,46 24,2 46,46" class="path"></polygon>
            </svg>

            <svg class="shape cross" xmlns="http://www.w3.org/2000/svg">
                <polygon points="2,35 13,24 2,13 13,2 24,13 35,2 46,13 35,24 46,35 35,46 24,35 13,46" class="path"><polygon>
            </svg>

            <svg class="shape diamond" xmlns="http://www.w3.org/2000/svg">
                <polygon points="8,24 24,2 40,24 24,46" class="path"><polygon>
            </svg>

            <svg class="shape pentagon" xmlns="http://www.w3.org/2000/svg">
                <polygon points="2,20 24,2 46,20 38,46 10,46" class="path"><polygon>
            </svg>

            <div class="rail">
                <div class="slot"></div>
            </div>
        </div>
    </div>

    <!-- Sound Resources -->
    <div id="soundManager">
        <div id="audioSingles">
        </div>
        <div id="audioInstances">
            <audio id="boop1" src="mp3/boop1.mp3" preload="auto"></audio>
            <audio id="boop2" src="mp3/boop2.mp3" preload="auto"></audio>
            <audio id="boop3" src="mp3/boop3.mp3" preload="auto"></audio>
        </div>
    </div>

    <!-- Twitter -->
    <script>
        !function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (!d.getElementById(id)) {
                js = d.createElement(s);
                js.id = id;
                js.src = "http://platform.twitter.com/widgets.js";
                fjs.parentNode.insertBefore(js, fjs);
            }
        } (document, "script", "twitter-wjs");</script>
</body>
</html>
